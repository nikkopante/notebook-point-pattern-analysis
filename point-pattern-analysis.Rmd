---
title: "Presentation Slides Notebook"
output:
  html_document:
    df_print: paged
---

# Point Patterns

## Objectives
1. Tignan yung events ay mag exhibit ng systematic pattern as oppose to being randomly distributed. Ito ba ay may clustering or regularity sa isang area kesa random or indenpendent scattering.
2. Tignan yung intensity ng mga point pattern kung nag va vary.
3. Tignan ang presenya ng spatial dependence among the events. Ito ay kung asan yung event B ay present kung meron event A.
4. Gumamit ng models para sa mga na observed na patterns.

## Analysis Approach
1. Patterns in event location are the focus.
2. Events may have attributes which can be used to distinguish types.
3. Stochastic aspect is where events are likely to occur.
4. Does a pattern exhibit clustering or regularity?
5. Over what spatial scales do patterns exist?

### 1st Order
* Sa 1st order effects ay interesado lamang tayo sa **means** and **variances**.
* Sa point pattern walang means kundi **intensity**. Tinitignan nito ang mean number of events per unit area. Ang intensity ay essentially a mean.
* Ang mathetical formula ng lambda(s) ay complicated. Ang intensity ay tinitignan yung mean number of event given a location and if you keep on making the area smaller you derive to the intensity. 
* Kung ang mga intensity may maliit lamang na variations, puwede natin masabi na ang point patterns ay **homogeneous**. 

### 2nd Order
* Ang 2nd order property ay ang number of events in pairs of areas.
* Ito ay mga spatial dependence kung saan kung may relasyon ang mga points sa isa't isa -- repel or cluster?
* Mahalaga ito makuha para malaman kung CSR, clustering or regularity ang point patterns dahil may kanya kanyang analysis ang bawat isa.
* Ito ay function ng dalawang location -- product of the two events i and j divided by the area of i and j

## Visualization Issues
1. May underlying population distribution from which events arise in a region.
2. If the population varies we would expect events to cluster in areas of high population. May clustering ba on the basis on the population alone?
3. Are they more or less clustered than we would expect on the basis of population alone.

## Exploring Point Patterns
1st order effects

* Quadrat Methods
* Kernel estimation

2nd order effects

* Nearest neighbors distances
* K-function

### Quadrat methods
Quadrat methods, summarize number of events in each quadrat in region R.
To get intesity, divide the quadrat result in the quadrat area.

Disadvantages:
* Loses spatial detail. Just count the number of events in each quadrat but does not determine if the scatter of the events. Sa modelling dapat ma describe pa rin natin ang events in terms of nearness or scatter.
* Converts data to area value.
* Making quadrats smaller generates *higher variation* and to some extremes some quadrats will have no data or 0.

Advantages:

```{r}
library(spatstat)
data(swedishpines)
x<-swedishpines
Q <- quadratcount(x, nx=4,ny=4)
plot(Q)
plot(round(Q/600,4))
Q2 <- quadratcount(x, nx=8,ny=8)
plot(Q2)
```

### Kernel Estimation
Ang Kernel estimation ay parang moving window Quadrat method. Gumagamit ito ng kernel at edge correction. Ang kernel ay ang moving window at posibleng may window kung saan kasali ang exterior ng study region. Ito ang tinatawag na edge correction.

Ang tau ay smoothing parameter.Ginagamit ito sa density mapping para ma visualize yung intensity. Imbes na moving window, ang kernel ay bilog at may radius, at kikuha lahat ng events sa loob.

Kapag malaki ang tau mas smooth, pero pag maliit may spikes on may improve yung intensity.

The contribution of an event can extend in multiple kernels unlike the contribution of event in quadrat in which is only in 1 quadrat.

**Adaptive Kernel Estimation** is one way to correct edge defects. Pwede iba iba ang tau dito kesa sa constant tau.
```{r}
plot(density(x,5),axes=FALSE)
plot(density(x,10),axes=FALSE)
plot(density(x,15),axes=FALSE)
```

### Nearest neighbor distances
Ito ay ginagamit upang mag investigate 2nd oder properties - kung ang pattern ba ay CSR, clustering or may regularity. Ang mga tanong ay, kung ang distribution ng distances. Kung may maraming nearest neighbor na maliit ang distances, pwede masabi na may clustering at kung malalaki naman ang distances ay maaring masabi na may regularity.

* event - event, distance between a random event to its nearest event, it can be a tall tree near a tall tree, both are events, this is actual data
* point - event, distance between a selected point to an event, a point could be empty, given a person location, is there a tall tree? this is representation of randomness,

Given ng dataset, ang W ay nearest neighbor of each event. This is the statistical measure, and will get a collection of metrics.
$$G_{hat}(w)=\frac{w_{no. events} \leq w_{nominated}}{n}$$
Ang G function ay gamit sa event-event (w), at F function ay sa point-event (x)

* Ang early sharpening could indicate clustering since marami na may close Ghat sa lower values ng w(distance). Dominant sa smaller w values.
* Ang late sharpening naman indicated repulsion kasi sa higher values of w(distance) na nagkaroon ng maraming distribution/frequency. Dominant sa high w values.

Dahil sa mga graph, ang CSR ay nag eexhibit ng stair-like juggedness. Or in general dapat sloping upwards.
```{r}
Fc <- Fest(cells) 
Gc <- Gest(cells) 
Kc <- Kest(cells) 
Lc <- Lest(cells) 

plot(Fc,rs~r,main="Border-corrected Estimate of F")
plot(Fc,theo~r,main="Poisson Estimate of F")
plot(Fc)
plot(Gc,rs~r,main="Border-corrected Estimate of G")
plot(Gc,theo~r,main="Poisson Estimate of G")
plot(Gc)
plot(Kc,border~r,main="Border-corrected Estimate of K")
plot(Kc,theo~r,main="Poisson Estimate of K")
plot(Kc)
plot(Lc,border~r,main="Border-corrected Estimate of L")
plot(Lc,theo~r,main="Poisson Estimate of L")
plot(Lc)
```

